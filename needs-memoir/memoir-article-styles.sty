%%% Some article styles and page layout tweaks for the memoir class
%%% Choose these as article or pagestyles for your memoir document. 
%%% @kjhealy, modified by @ericmhuntley


% --------------------------------------------------
% Some useful bits and pieces
% --------------------------------------------------
% Blank footnote command.
% Use \symbolfootnote[0]{Footnote text} for a blank footnote. 
% Useful for an initial acknowledgment note.
\long\def\symbolfootnote[#1]#2{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnote[#1]{#2}\endgroup}

% Redefine \and and \andnext to remove tabular environment.
% Needed below for custom article-styles when multiple authors are present. 
\renewcommand{\and}{\, }
\renewcommand*{\andnext}{%
  \\\medskip }

% Custom hanging indent for vita items
\def\mybibind{\hangindent=1 true cm\hangafter=1 \noindent}

% --------------------------------------------------
% Style: article 
% --------------------------------------------------

% Make the style for Chapters and sections
   \makechapterstyle{article}{
    \setsecheadstyle{\Large\scshape\MakeLowercase} 
    \setsubsecheadstyle{\normalsize\itshape} 
	\setaftersubsubsecskip{-1em}
    \setsubsubsecheadstyle{\small\bfseries}
    \renewcommand{\printchaptername}{} 
    \renewcommand{\chapternamenum}{} 
    \renewcommand{\chapnumfont}{\chaptitlefont} 
    \renewcommand{\printchapternum}{\chapnumfont \thechapter\space} 
    \renewcommand{\afterchapternum}{} 
    \renewcommand{\printchaptername}{\secheadstyle}
    \renewcommand{\cftchapterfont}{\normalfont} 
    \renewcommand{\cftchapterpagefont}{\normalfont\scshape} 
    \renewcommand{\cftchapterpresnum}{\scshape} 
    %\renewcommand{\cftchapterleader}{} 
    %\renewcommand{\cftchapterafterpnum}{\cftparfillskip}
    \captiontitlefont{\small}
    %\settocdepth{chapter}
    \maxsecnumdepth{chapter} 
    \setsecnumdepth{chapter}

    % reduce skip after section heading
    \setaftersecskip{1.7ex}

    % insert date of last github commit before title
    \renewcommand{\maketitlehooka}{\begin{flushleft}\normalsize\printdate{\VCDateISO}\end{flushleft}}

    % Title flush left
    \pretitle{\par\vskip 3em 
        \begin{flushleft}\LARGE\bfseries}
    \posttitle{\end{flushleft}\par\vskip 0.5em}
    \preauthor{\begin{flushleft}\normalsize\bigskip}
    \postauthor{\end{flushleft}}
    %% \predate{\begin{flushleft}\normalsize}
    %% \postdate{\end{flushleft}}

    % 'abstract' bigger skip from title
    \addto\captionsamerican{\renewcommand{\abstractname}{}}
    \renewcommand{\abstractname}{}
    \renewcommand{\abstracttextfont}{\normalfont\scriptsize}
    \abstractrunin
   }


% -------------------------------------------------- 
% Custom styles for headers and footers The chapterstyles above
% style sections/subsections and titles, etc. These pagestyles
% control the running headers and footers.
% --------------------------------------------------
   
% Basic 
\makepagestyle{kjh}
%\makeevenfoot{kjh}{\thepage}{}{}
%\makeoddfoot{kjh}{}{}{\thepage}
%\makeheadrule{kjh}{\textwidth}{\normalrulethickness}
\newcommand{\@kjhmarks}{%
  \let\@mkboth\markboth
  \def\chaptermark##1{%
    \markboth{%
      \ifnum \c@secnumdepth >\m@ne
        \if@mainmatter
          \thechapter. \ %
        \fi
      \fi
      ##1}{}}
  \def\sectionmark##1{%
    \markright{##1}}
}
\makepsmarks{kjh}{\@kjhmarks}
\makepsmarks{kjh}{}
\makeevenhead{kjh}{}{}{\scshape\thepage}
\makeoddhead{kjh}{}{}{\scshape\thepage}


%
% Git info in footers; requires vc package 
%

% Make the style for vc-git revision control headers and footers
\makepagestyle{kjhgit}
% \makeheadrule{kjhgit}{\textwidth}{\normalrulethickness}
\aliaspagestyle{title}{kjhgit}
\makeevenfoot{kjhgit}{}{\scshape\thepage}{}
\makeoddfoot{kjhgit}{}{\scshape\thepage}{}
\makeevenhead{kjhgit}{}{\texttt{\footnotesize \VCRevision\ by \VCAuthor\ on \VCDateISO at \VCTime}}{}
\makeoddhead{kjhgit}{}{\texttt{\footnotesize \VCRevision\ by \VCAuthor\ on \VCDateISO\ at \VCTime}}{}      
